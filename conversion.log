2024-11-19 20:36:01,362 - INFO - Loading CSV data...
2024-11-19 20:36:01,389 - ERROR - Error converting CSV to SQLite
Traceback (most recent call last):
  File "/Users/anilbh/Music/Staffdb/.venv/lib/python3.12/site-packages/pandas/core/indexes/base.py", line 3805, in get_loc
    return self._engine.get_loc(casted_key)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "index.pyx", line 167, in pandas._libs.index.IndexEngine.get_loc
  File "index.pyx", line 196, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 7081, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 7089, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Booth Sl.No.'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/anilbh/Music/Staffdb/main.py", line 26, in csv_to_sqlite
    df['Booth Sl.No.'] = df['Booth Sl.No.'].astype('int')
                         ~~^^^^^^^^^^^^^^^^
  File "/Users/anilbh/Music/Staffdb/.venv/lib/python3.12/site-packages/pandas/core/frame.py", line 4102, in __getitem__
    indexer = self.columns.get_loc(key)
              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/anilbh/Music/Staffdb/.venv/lib/python3.12/site-packages/pandas/core/indexes/base.py", line 3812, in get_loc
    raise KeyError(key) from err
KeyError: 'Booth Sl.No.'
2024-11-19 20:36:37,352 - INFO - Loading CSV data...
2024-11-19 20:36:37,377 - ERROR - Error converting CSV to SQLite
Traceback (most recent call last):
  File "/Users/anilbh/Music/Staffdb/main.py", line 25, in csv_to_sqlite
    df['Sl.No.'] = df['Sl.No.'].astype('int')
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/anilbh/Music/Staffdb/.venv/lib/python3.12/site-packages/pandas/core/generic.py", line 6643, in astype
    new_data = self._mgr.astype(dtype=dtype, copy=copy, errors=errors)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/anilbh/Music/Staffdb/.venv/lib/python3.12/site-packages/pandas/core/internals/managers.py", line 430, in astype
    return self.apply(
           ^^^^^^^^^^^
  File "/Users/anilbh/Music/Staffdb/.venv/lib/python3.12/site-packages/pandas/core/internals/managers.py", line 363, in apply
    applied = getattr(b, f)(**kwargs)
              ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/anilbh/Music/Staffdb/.venv/lib/python3.12/site-packages/pandas/core/internals/blocks.py", line 758, in astype
    new_values = astype_array_safe(values, dtype, copy=copy, errors=errors)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/anilbh/Music/Staffdb/.venv/lib/python3.12/site-packages/pandas/core/dtypes/astype.py", line 237, in astype_array_safe
    new_values = astype_array(values, dtype, copy=copy)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/anilbh/Music/Staffdb/.venv/lib/python3.12/site-packages/pandas/core/dtypes/astype.py", line 182, in astype_array
    values = _astype_nansafe(values, dtype, copy=copy)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/anilbh/Music/Staffdb/.venv/lib/python3.12/site-packages/pandas/core/dtypes/astype.py", line 133, in _astype_nansafe
    return arr.astype(dtype, copy=True)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
ValueError: invalid literal for int() with base 10: 'AMAN TIWARI'
2024-11-19 20:37:25,859 - INFO - Loading CSV data...
2024-11-19 20:37:25,873 - ERROR - Error converting CSV to SQLite
Traceback (most recent call last):
  File "/Users/anilbh/Music/Staffdb/.venv/lib/python3.12/site-packages/pandas/core/indexes/base.py", line 3805, in get_loc
    return self._engine.get_loc(casted_key)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "index.pyx", line 167, in pandas._libs.index.IndexEngine.get_loc
  File "index.pyx", line 196, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 7081, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 7089, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Booth Sl.No.'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/anilbh/Music/Staffdb/main.py", line 26, in csv_to_sqlite
    df['Booth Sl.No.'] = df['Booth Sl.No.'].astype('int')
                         ~~^^^^^^^^^^^^^^^^
  File "/Users/anilbh/Music/Staffdb/.venv/lib/python3.12/site-packages/pandas/core/frame.py", line 4102, in __getitem__
    indexer = self.columns.get_loc(key)
              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/anilbh/Music/Staffdb/.venv/lib/python3.12/site-packages/pandas/core/indexes/base.py", line 3812, in get_loc
    raise KeyError(key) from err
KeyError: 'Booth Sl.No.'
2024-11-19 20:40:23,568 - INFO - Loading CSV data...
2024-11-19 20:40:23,590 - INFO - Columns in CSV: ['Sl.No.', 'Booth_Sl.No.', 'Name', 'Post/ Designation', 'PF_No', 'HRMS ID', 'Working Under', 'Station / Place where posted', 'Booth No.', 'Booth Name', 'Remarks']
2024-11-19 20:40:23,591 - ERROR - Error converting CSV to SQLite
Traceback (most recent call last):
  File "/Users/anilbh/Music/Staffdb/main.py", line 29, in csv_to_sqlite
    df['Booth_Sl.No.'] = df['Booth_Sl.No.'].astype('int')
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/anilbh/Music/Staffdb/.venv/lib/python3.12/site-packages/pandas/core/generic.py", line 6643, in astype
    new_data = self._mgr.astype(dtype=dtype, copy=copy, errors=errors)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/anilbh/Music/Staffdb/.venv/lib/python3.12/site-packages/pandas/core/internals/managers.py", line 430, in astype
    return self.apply(
           ^^^^^^^^^^^
  File "/Users/anilbh/Music/Staffdb/.venv/lib/python3.12/site-packages/pandas/core/internals/managers.py", line 363, in apply
    applied = getattr(b, f)(**kwargs)
              ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/anilbh/Music/Staffdb/.venv/lib/python3.12/site-packages/pandas/core/internals/blocks.py", line 758, in astype
    new_values = astype_array_safe(values, dtype, copy=copy, errors=errors)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/anilbh/Music/Staffdb/.venv/lib/python3.12/site-packages/pandas/core/dtypes/astype.py", line 237, in astype_array_safe
    new_values = astype_array(values, dtype, copy=copy)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/anilbh/Music/Staffdb/.venv/lib/python3.12/site-packages/pandas/core/dtypes/astype.py", line 182, in astype_array
    values = _astype_nansafe(values, dtype, copy=copy)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/anilbh/Music/Staffdb/.venv/lib/python3.12/site-packages/pandas/core/dtypes/astype.py", line 133, in _astype_nansafe
    return arr.astype(dtype, copy=True)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
ValueError: invalid literal for int() with base 10: 'T1'
2024-11-19 20:43:54,772 - INFO - Loading CSV data...
2024-11-19 20:43:54,800 - INFO - Columns in CSV: ['Sl.No.', 'Booth_Sl.No.', 'Name', 'Post/ Designation', 'PF_No', 'HRMS ID', 'Working Under', 'Station / Place where posted', 'Booth No.', 'Booth Name', 'Remarks']
2024-11-19 20:43:54,802 - INFO - 'Booth_Sl.No.' treated as string.
2024-11-19 20:43:54,802 - ERROR - Error converting CSV to SQLite
Traceback (most recent call last):
  File "/Users/anilbh/Music/Staffdb/.venv/lib/python3.12/site-packages/pandas/core/indexes/base.py", line 3805, in get_loc
    return self._engine.get_loc(casted_key)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "index.pyx", line 167, in pandas._libs.index.IndexEngine.get_loc
  File "index.pyx", line 196, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 7081, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 7089, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Post_Designation'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/anilbh/Music/Staffdb/main.py", line 35, in csv_to_sqlite
    df['Post_Designation'] = df['Post_Designation'].astype('category')
                             ~~^^^^^^^^^^^^^^^^^^^^
  File "/Users/anilbh/Music/Staffdb/.venv/lib/python3.12/site-packages/pandas/core/frame.py", line 4102, in __getitem__
    indexer = self.columns.get_loc(key)
              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/anilbh/Music/Staffdb/.venv/lib/python3.12/site-packages/pandas/core/indexes/base.py", line 3812, in get_loc
    raise KeyError(key) from err
KeyError: 'Post_Designation'
2024-11-19 20:48:00,425 - INFO - Loading CSV data...
2024-11-19 20:48:00,452 - INFO - Columns in CSV: ['Sl.No.', 'Booth_Sl.No.', 'Name', 'Post/ Designation', 'PF_No', 'HRMS ID', 'Working Under', 'Station / Place where posted', 'Booth No.', 'Booth Name', 'Remarks']
2024-11-19 20:48:00,496 - INFO - CSV data successfully loaded into SQLite database.
